[{"id":"f6f2187d.f17ca8","type":"tab","label":"Data Lake","disabled":false,"info":"","env":[]},{"id":"49d299e0809a0934","type":"comment","z":"f6f2187d.f17ca8","name":"ELT - Data Pipeline","info":"Extract-Load-Transform Data Movement\n\nhttps://www.youtube.com/watch?v=B6RDjs7D-qY\n\nhttps://www.youtube.com/watch?v=IF5YrYiV0sA\n\nETL:\n1. Most Reliable & Governable (for compliance)\n2. Structured but Complex\n3. Effective - Many Supporting Tools\n4. Takes more Time+Effort\n\nELT:\n1. Faster (12 hrs to 12 minutes)\n2. Good for Machine Learning\n3. Good for Analytics & Quick Insights\n4. Agile + Less Maintenance","x":130,"y":80,"wires":[]},{"id":"5f415dfa037b3e71","type":"inject","z":"f6f2187d.f17ca8","name":"inject","props":[{"p":"payload"},{"p":"filename","v":"$millis()&\".json\"","vt":"jsonata"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"datalake","payload":"true","payloadType":"bool","x":55,"y":180,"wires":[["ba55749994d783c6"]],"l":false},{"id":"ba55749994d783c6","type":"http request","z":"f6f2187d.f17ca8","name":"Extract","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://api.v2.emissions-api.org/api/v2/carbonmonoxide/average.json?country=DE&begin=2019-02-01&end=2019-03-01","tls":"","persist":false,"proxy":"","authType":"","senderr":false,"x":140,"y":180,"wires":[["fd86705dd102e3be"]]},{"id":"fe0d6329041429bc","type":"change","z":"f6f2187d.f17ca8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.average","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":560,"y":280,"wires":[["9f7fa79f7c3a0c0c"]]},{"id":"fd86705dd102e3be","type":"file","z":"f6f2187d.f17ca8","name":"Load","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":270,"y":180,"wires":[["82146e43ef33c21f","f97ef72df40a2625","b701cfc9638e4ca9"]]},{"id":"82146e43ef33c21f","type":"file in","z":"f6f2187d.f17ca8","name":"Storage","filename":"","format":"utf8","chunk":false,"sendError":false,"encoding":"none","allProps":false,"x":300,"y":120,"wires":[["86118746a4ed5b80"]]},{"id":"7a84f0ed813e0aa8","type":"debug","z":"f6f2187d.f17ca8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":675,"y":200,"wires":[],"l":false},{"id":"86118746a4ed5b80","type":"change","z":"f6f2187d.f17ca8","name":"Transform","rules":[{"t":"set","p":"payload","pt":"msg","to":"$trim(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":120,"wires":[["4931b589db60d63a"]]},{"id":"b3934bbe827de703","type":"watch","z":"f6f2187d.f17ca8","name":"lake.json","files":"/usr/src/node-red/","recursive":"","x":360,"y":60,"wires":[["99c5f2558b8ab230"]]},{"id":"99c5f2558b8ab230","type":"debug","z":"f6f2187d.f17ca8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":475,"y":60,"wires":[],"l":false},{"id":"f97ef72df40a2625","type":"split","z":"f6f2187d.f17ca8","name":"","splt":"}","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":410,"y":220,"wires":[["7e4ba242cf8c9b97"]]},{"id":"7e4ba242cf8c9b97","type":"join","z":"f6f2187d.f17ca8","name":"","mode":"custom","build":"array","property":"payload.average","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":550,"y":220,"wires":[["7a84f0ed813e0aa8","fe0d6329041429bc"]]},{"id":"4931b589db60d63a","type":"debug","z":"f6f2187d.f17ca8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":575,"y":120,"wires":[],"l":false},{"id":"b701cfc9638e4ca9","type":"debug","z":"f6f2187d.f17ca8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"filename","targetType":"msg","statusVal":"","statusType":"auto","x":395,"y":180,"wires":[],"l":false},{"id":"59a486f7e14a201d","type":"inject","z":"f6f2187d.f17ca8","name":"inject","props":[{"p":"payload"},{"p":"filename","v":"$millis()&\".json\"","vt":"jsonata"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"datalake","payload":"true","payloadType":"bool","x":95,"y":280,"wires":[["919e9fac6b39e15e"]],"l":false},{"id":"919e9fac6b39e15e","type":"file in","z":"f6f2187d.f17ca8","name":"Read Storage","filename":"","format":"utf8","chunk":false,"sendError":false,"encoding":"none","allProps":false,"x":220,"y":280,"wires":[["f2495fa911f7ee63"]]},{"id":"f2495fa911f7ee63","type":"debug","z":"f6f2187d.f17ca8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":355,"y":280,"wires":[],"l":false},{"id":"9f7fa79f7c3a0c0c","type":"function","z":"f6f2187d.f17ca8","name":"Populate","func":"var m = [\n    {topic:\"X\", payload:msg.payload[0]},\n    {topic:\"Y\", payload:msg.payload[1]},\n    {topic:\"Z\", payload:msg.payload[2]}\n    ];\nreturn [m];","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":540,"y":340,"wires":[["330d8390bef12586"]]},{"id":"330d8390bef12586","type":"ui_chart","z":"f6f2187d.f17ca8","name":"","group":"0ee2c4781f4e9369","order":2,"width":0,"height":0,"label":"bar chart","chartType":"bar","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"No Data","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":680,"y":340,"wires":[[]]},{"id":"0ee2c4781f4e9369","type":"ui_group","name":"Group 1","tab":"4dfa4884caed2f75","order":1,"disp":true,"width":10},{"id":"4dfa4884caed2f75","type":"ui_tab","name":"Tab 1","icon":"dashboard","order":1}]
